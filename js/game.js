/*! 2014-10-14 */
(function(){window.Game={WIDTH:960,HEIGHT:540,GRID_WIDTH:198,nPlayers:1,showDebugBodies:!1,assetsRoot:"assets/"}}).call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};Game.Player=function(b){function d(b,c,e,f){this.isMoving=a(this.isMoving,this),this.mapMove=a(this.mapMove,this),this.mapWarp=a(this.mapWarp,this),d.__super__.constructor.call(this,b,0,0,"altas_main","player_1"),this.anchor.setTo(0,0),this.game=b,this.gameState=c,this.mapWarp(e,f),b.add.existing(this)}return c(d,b),d.prototype.gameState=null,d.prototype.tweenMove=null,d.prototype.mapX=0,d.prototype.mapY=0,d.prototype.mapWarp=function(a,b){return this.mapX=a,this.mapY=b,this.reset(this.mapX*Game.GRID_WIDTH,this.mapY*Game.GRID_WIDTH)},d.prototype.mapMove=function(a,b){return this.isMoving()?void 0:(this.tweenMove=this.game.add.tween(this).to({x:a*Game.GRID_WIDTH,y:b*Game.GRID_WIDTH},300,Phaser.Easing.None,!0),this.mapX=a,this.mapY=b)},d.prototype.isMoving=function(){var a;return(null!=(a=this.tweenMove)?a.isRunning:void 0)||!1},d.prototype.update=function(){},d}(Phaser.Sprite)}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};Game.Wall=function(a){function c(a,b,d,e,f){c.__super__.constructor.call(this,a,320,340,f),this.anchor.setTo(0,0),this.mapX=d,this.mapY=e,this.game=a,this.gameState=b,this.reset(this.mapX*this.width,this.mapY*this.height),a.add.existing(this)}return b(c,a),c.prototype.gameState=null,c.prototype.mapX=0,c.prototype.mapY=0,c.prototype.update=function(){},c}(Phaser.Sprite)}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};Game.StateBoot=function(a){function c(){c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.preload=function(){return this.load.image("preloadBar",Game.assetsRoot+"loader.png"),this.stage.disableVisibilityChange=!0,this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.scale.minWidth=480,this.scale.minHeight=270,this.scale.maxWidth=5760,this.scale.maxHeight=3240,this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.scale.setScreenSize(!0),this.game.input.gamepad.start(),this.game.input.keyboard.addKeyCapture([Phaser.Keyboard.LEFT,Phaser.Keyboard.RIGHT,Phaser.Keyboard.UP,Phaser.Keyboard.DOWN,Phaser.Keyboard.BACKSPACE,Phaser.Keyboard.SPACEBAR])},c.prototype.create=function(){return this.game.state.start("Preloader",!0,!1)},c}(Phaser.State)}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};Game.StateGame=function(b){function d(){this.render=a(this.render,this),this.update=a(this.update,this),this.create=a(this.create,this),this.isSpace=a(this.isSpace,this),this.movePlayer=a(this.movePlayer,this),this.flipToMap=a(this.flipToMap,this),d.__super__.constructor.apply(this,arguments)}var e;return c(d,b),d.prototype.textFPS=null,d.prototype.player=null,d.prototype.mapObjects=null,d.prototype.mapCurrent=null,e=100,d.prototype.maps=[{name:"green",data:[[0,1,1,0,0],[0,1,0,0,1],[0,0,0,1,1],[1,1,0,0,0],[1,1,1,1,0]]},{name:"red",data:[[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0]]}],d.prototype.flipToMap=function(a){var b,c,d,e,f,g,h,i,j;for(this.mapCurrent=a,this.mapObjects.removeAll(!0),i=this.maps[this.mapCurrent].data,j=[],f=g=0,h=i.length;h>g;f=++g)d=i[f],j.push(function(){var a,g,h;for(h=[],e=a=0,g=d.length;g>a;e=++a)b=d[e],1===b?(c=new Game.Wall(this.game,this,e,f,this.maps[this.mapCurrent].name),h.push(this.mapObjects.add(c))):h.push(void 0);return h}.call(this));return j},d.prototype.movePlayer=function(a,b){var c,d;return this.isSpace(this.player.mapX,this.player.mapY)&&(c=this.player.mapX+a,d=this.player.mapY+b,this.isSpace(c,d))?this.player.mapMove(c,d):void 0},d.prototype.isSpace=function(a,b){var c;return 0===(null!=(c=this.maps[this.mapCurrent].data[b])?c[a]:void 0)},d.prototype.create=function(){var a,b=this;return this.game.world.setBounds(0,0,2e4,2e4),this.mapObjects=this.game.add.group(),this.flipToMap(1),this.player=new Game.Player(this.game,this,0,0),this.game.camera.follow(this.player),this.game.time.advancedTiming=!0,this.textFPS=this.add.text(520,30,"FPS",{font:"30px Arial",fill:"rgb(1, 51, 209)",align:"center"}),this.textFPS.fixedToCamera=!0,this.textFPS.anchor.setTo(.5,0),a=new Game.DimensionPicker(this.game,this.flipToMap),a.load(this.maps),this.game.input.keyboard.addKey(Phaser.Keyboard.ONE).onDown.add(function(){return b.flipToMap(0)}),this.game.input.keyboard.addKey(Phaser.Keyboard.TWO).onDown.add(function(){return b.flipToMap(1)}),this.screenBottom=this.game.height-e,this.screenLine1=new Phaser.Line(0,0,this.game.width,this.screenBottom),this.screenLine2=new Phaser.Line(this.game.width,0,0,this.screenBottom),this.pointerLine=new Phaser.Line(0,0,0,0)},d.prototype.update=function(){var a,b;return this.game.input.keyboard.isDown(Phaser.Keyboard.DOWN)&&this.movePlayer(0,1),this.game.input.keyboard.isDown(Phaser.Keyboard.UP)&&this.movePlayer(0,-1),this.game.input.keyboard.isDown(Phaser.Keyboard.LEFT)&&this.movePlayer(-1,0),this.game.input.keyboard.isDown(Phaser.Keyboard.RIGHT)&&this.movePlayer(1,0),this.game.input.activePointer.isDown&&this.game.input.activePointer.y<this.screenBottom&&(this.pointerLine.setTo(this.game.input.activePointer.x,0,this.game.input.activePointer.x,this.game.input.activePointer.y),a=null===this.screenLine1.intersects(this.pointerLine),b=null===this.screenLine2.intersects(this.pointerLine),a&&b?this.movePlayer(0,-1):b?this.movePlayer(-1,0):a?this.movePlayer(1,0):this.movePlayer(0,1)),this.game.input.gamepad.pad1.isDown(Phaser.Gamepad.BUTTON_3)||this.game.input.keyboard.isDown(Phaser.Keyboard.BACKSPACE)?this.game.state.start("TitleScreen",!0,!1):void 0},d.prototype.render=function(){return this.textFPS.setText("FPS: "+this.game.time.fps)},d}(Phaser.State)}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};Game.StatePreloader=function(a){function c(){c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.preloadBar=null,c.prototype.preload=function(){return this.preloadBar=this.add.sprite(this.world.centerX-200,250,"preloadBar"),this.load.setPreloadSprite(this.preloadBar),this.game.load.atlas("altas_main",Game.assetsRoot+"main0.png",Game.assetsRoot+"main0.json"),this.game.load.image("title",Game.assetsRoot+"title.png"),this.game.load.image("Button",Game.assetsRoot+"Button.png"),this.game.load.image("bound",Game.assetsRoot+"bound.png"),this.game.load.image("green",Game.assetsRoot+"green.png"),this.game.load.image("red",Game.assetsRoot+"red.png"),this.game.load.image("icon_green",Game.assetsRoot+"icon_green.png"),this.game.load.image("icon_red",Game.assetsRoot+"icon_red.png")},c.prototype.create=function(){var a;return a=this.add.tween(this.preloadBar).to({alpha:0},1e3,Phaser.Easing.Linear.None,!0),a.onComplete.add(this.startMainMenu,this)},c.prototype.startMainMenu=function(){return this.game.state.start("TitleScreen",!0,!1)},c}(Phaser.State)}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};Game.StateTitleScreen=function(b){function d(){this.update=a(this.update,this),this.create=a(this.create,this),d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype.create=function(){var a,b,c,d;return b={font:"20px Arial",fill:"#12D523",align:"center"},d=this.add.text(this.world.centerX,this.world.centerY,"Play Game!",b),d.anchor.setTo(.5,.5),a={font:"20px Arial",fill:"#E2D533",align:"center"},c=this.add.text(this.world.centerX,Game.HEIGHT-50,"(c) 2014 Cool dudes",a),c.anchor.setTo(.5,1)},d.prototype.goPlay=function(){return this.game.state.start("Game",!0,!1)},d.prototype.update=function(){return this.game.input.gamepad.pad1.isDown(Phaser.Gamepad.BUTTON_0)||this.game.input.activePointer.isDown||this.game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)?this.goPlay():void 0},d}(Phaser.State)}.call(this),function(){Game.DimensionPicker=function(){function a(a,b){this.game=a,this.pickedCallback=b,this.pickerButtons=this.game.add.group()}return a.prototype.game=null,a.prototype.pickedCallback=null,a.prototype.dimNames=[],a.prototype.pickerButtons=null,a.prototype.load=function(a){var b=this;return this.pickerButtons.removeAll(!0),this.dimNames=_.pluck(a,"name"),_.each(this.dimNames,function(a,c){var d;return d=b.game.add.sprite(50+120*c,Game.HEIGHT-100,"icon_"+a),d.fixedToCamera=!0,d.inputEnabled=!0,d.events.onInputUp.add(function(){return b.pickedCallback(c)}),b.pickerButtons.add(d)})},a}()}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};Game.Button=function(a){function c(a,b,d,e,f,g,h,i){c.__super__.constructor.call(this,a,b,d,f),a.add.existing(this),this.callback=_.bind(g,h),this.label=new Phaser.Text(a,0,0,"Label",this.style.enabled),this.addChild(this.label),this.label.anchor.setTo(.5,.5),this.setText(e||"Label"),this.inputEnabled=!1,this.setDisabled(!1),this.width=i,this.label.scale.x=1/this.scale.x}return b(c,a),c.prototype.style={enabled:{font:"20px Arial",fill:"black"},disabled:{font:"20px Arial",fill:"#5A5A5A"}},c.prototype.callback=null,c.prototype.setText=function(a){return this.label.setText(a),this.centerLabel()},c.prototype.centerLabel=function(){return this.label.x=Math.floor(.5*this.width),this.label.y=Math.floor(.5*this.height)},c.prototype.setDisabled=function(a){return this.inputEnabled!==!a?(this.inputEnabled=!a,a?(this.label.setStyle(this.style.disabled),this.events.onInputUp.removeAll()):(this.label.setStyle(this.style.enabled),this.events.onInputUp.add(this.callback))):void 0},c}(Phaser.Button)}.call(this),function(){Game.Main=function(){function a(){this.game=new Phaser.Game(Game.WIDTH,Game.HEIGHT,Phaser.AUTO,"gameHolderID",null),this.game.state.add("Boot",new Game.StateBoot,!1),this.game.state.add("Preloader",new Game.StatePreloader,!1),this.game.state.add("TitleScreen",new Game.StateTitleScreen,!1),this.game.state.add("Game",new Game.StateGame,!1),this.game.state.start("Boot")}return a}(),function(){return new Game.Main}()}.call(this);